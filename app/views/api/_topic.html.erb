<div class="juvia-container"
	data-site-key="<%= @site_key %>"
	data-topic-key="<%= @topic_key %>"
	data-topic-title="<%= @topic_title %>"
	data-topic-url="<%= @topic_url %>">
<div class="juvia-topic">
	<% if @require_external_user %>
	  <% if @user_logged_in %> 
	    <%= render :partial => 'like_unlike'%>
	    <h3>Add comment</h3>
	    <%= render :partial => 'user_form' %>
      <%= render :partial => 'markdown_help' %>
	  <% else %>
	    <h3><%= @logged_in_message.html_safe %></h3>
	    <%= render :partial => 'like_unlike'%>
	  <% end %>
    <% else %>
      <%= render :partial => 'like_unlike'%>
      <h3>Add comment</h3>
      <%= render :partial => 'form' %>
      <%= render :partial => 'markdown_help' %>
    <% end %>
	<% comments = topic.comments.visible.to_a %>
	<% if comments.size == 1 %>
	    <%=render :partial=>"sorting", :locals => {:total_comments =>"1 comment", :sorting_option => false}%>
		<div class="juvia-comments" id="juvia-comments-box"></div>
	<% elsif comments.size > 1 %>
		<%=render :partial=>"sorting", :locals => { :total_comments =>"Showing #{comments.size.to_s} comments" , :sorting_option => true}%>
		<div class="juvia-comments" id="juvia-comments-box"></div>
	<% else %>
	    <%=render :partial=>"sorting", :locals => {:total_comments =>"", :sorting_option => false}%>
		<div class="juvia-comments juvia-no-comments" id="juvia-comments-box">There are no comments yet.</div>
	<% end %>
</div>
</div> <!-- juvia-container -->
